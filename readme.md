# 鸟群算法模拟器 (Boid Algorithm Simulation)

## 项目概述

这是一个基于JavaScript实现的鸟群算法(Boid Algorithm)可视化模拟器，展示了Craig Reynolds在1986年提出的经典群体行为模型。项目提供了2D和3D两种可视化模式，用户可以实时调整参数观察群体行为的变化。

## 需求要点

### 核心功能需求
1. **鸟群三大基本行为**：
   - **分离(Separation)**: 个体避免与邻近个体发生碰撞
   - **对齐(Alignment)**: 个体与邻近个体保持相同的运动方向
   - **内聚(Cohesion)**: 个体向邻近个体的平均位置靠拢

2. **可视化需求**：
   - 支持2D Canvas渲染的平面模拟
   - 支持3D WebGL渲染的立体模拟
   - 实时动画显示群体运动轨迹

3. **交互控制需求**：
   - 实时调整群体数量(10-500个个体)
   - 动态调整三种行为力的权重(0-2.0)
   - 标签页切换2D/3D视图模式

4. **性能需求**：
   - 流畅的动画帧率
   - 支持大规模群体(最多500个个体)
   - 优化的碰撞检测算法

## 技术实现

### 架构设计

```
项目结构：
├── index.html          # 主页面，包含UI控制面板
├── boid.js            # 2D鸟群个体类实现
├── boid3D.js          # 3D鸟群个体类实现
├── Vector3D.js        # 3D向量数学运算库
├── main.js            # 2D场景主控制逻辑
├── main3D.js          # 3D场景主控制逻辑
└── readme.md          # 项目文档
```

### 核心技术栈

- **前端框架**: 原生JavaScript (ES6+)
- **2D渲染**: HTML5 Canvas API
- **3D渲染**: Three.js WebGL库
- **数学计算**: 自定义Vector和Vector3D向量类
- **界面控制**: HTML5 Range滑块 + CSS3样式

### 算法实现细节

#### 1. 鸟群个体(Boid)类
```javascript
class Boid {
    constructor(x, y) {
        this.position = new Vector(x, y);     // 位置向量
        this.velocity = Vector.random2D();    // 速度向量
        this.acceleration = new Vector(0, 0); // 加速度向量
        this.maxForce = 0.2;                 // 最大转向力
        this.maxSpeed = 4;                   // 最大速度
    }
}
```

#### 2. 三大核心行为算法

**分离行为 (Separation)**:
- 感知半径: 50像素
- 计算与邻近个体的反向力
- 距离越近，排斥力越强 (反平方定律)

**对齐行为 (Alignment)**:
- 感知半径: 50像素  
- 计算邻近个体的平均速度方向
- 调整自身速度向量趋向平均方向

**内聚行为 (Cohesion)**:
- 感知半径: 100像素
- 计算邻近个体的重心位置
- 产生向重心移动的转向力

#### 3. 向量数学运算
```javascript
// 2D向量类支持的运算
- add(): 向量加法
- sub(): 向量减法  
- mult(): 标量乘法
- div(): 标量除法
- mag(): 计算模长
- setMag(): 设置模长
- limit(): 限制最大模长
```

#### 4. 边界处理
- **2D模式**: 环绕边界(Wrapping) - 个体飞出边界时从对侧重新进入
- **3D模式**: 边界反弹 - 在立方体空间内运动

#### 5. 渲染优化
- **2D渲染**: 使用Canvas的requestAnimationFrame优化动画
- **3D渲染**: Three.js的网格实例化减少几何体创建开销
- **视锥裁剪**: 只渲染相机视野内的对象

### 性能特性

1. **空间分割**: 邻居搜索算法优化，避免O(n²)复杂度
2. **向量池化**: 减少频繁的对象创建和垃圾回收
3. **GPU加速**: 3D模式利用WebGL硬件加速渲染
4. **自适应质量**: 根据性能动态调整渲染质量

### 使用说明

1. **启动项目**: 直接在浏览器中打开`index.html`
2. **切换模式**: 点击"2D Simulation"或"3D Simulation"标签
3. **调整参数**:
   - 拖拽"Flock Size"滑块改变群体数量
   - 调整"Alignment"、"Cohesion"、"Separation"权重观察行为变化
4. **3D交互**: 在3D模式下可以用鼠标拖拽旋转视角，滚轮缩放

### 扩展可能性

- 添加障碍物避让行为
- 实现捕食者-猎物动态
- 引入环境因素(风力、重力)
- 支持不同种类的群体交互
- 数据可视化和行为分析工具
